
import numpy as np
import pygame

pygame.init()
info = pygame.display.Info()

# Display settings
REFERENCE_SIZE = (1920, 1080)
screen_width, screen_height = info.current_w, info.current_h
aspect_x = screen_width - (screen_width % 16)
aspect_y = screen_height - (screen_height % 9)
DISPLAY_SIZE = (aspect_x, aspect_y)
FPS = 60
WIDTH, HEIGHT = 1600, 900

# Colors
GOLD = (255, 215, 0)
GREEN = (0, 255, 0)
WHITE = (255, 255, 255)
RED = (255, 0, 0)
DODGERBLUE = (30, 144, 255)
DARKGREEN = (0, 200, 0)
BLACK = (0, 0, 0)
GRAY = (128, 128, 128)
YELLOW = (255, 255, 0)
DARKGRAY = (20, 20, 20)
ORANGE = (255, 165, 0)

# Car colors
CAR_COLORS = {
    "Red": r"data\photo\car-red.png",
    "Blue": r"data\photo/car-blue.png",
    "Black": r"data\photo/car-black.png",
    "Yellow": r"data\photo/car-yellow.png",
    "White": r"data\photo/car-white.png",
}
COLORS = {
    "title": (255, 181, 33),
    "p1": (0, 128, 255),
    "p2": (255, 0, 0),
    "selected": (255, 186, 48),
    "inactive": (86, 86, 86),
    "border": (224, 224, 216),
    "button_bg": (240, 240, 232),
    "start": (90, 158, 68),
    "back": (102, 102, 102)
}

CAR_COLORS_LIST = list(CAR_COLORS.keys())
# Game settings
CAR_START_POS = (350, 225)
CAR1_FAIR_START = (330, 219)
CAR2_FAIR_START = (363, 180)

FINISHLINE_POS = np.array([268, 250])
FINISHLINE_SIZE = (162, 25)

OBSTACLE_SIZE = (20, 20)
OBSTACLE_HITBOX = (5, 5, 10, 10)  # x, y, width, height
NUM_OBSTACLES = 15
OBSTACLE_VELOCITY_REDUCTION = 0.05

TARGET_TIME = 25.0

INFERENCE_EPSILON = 0.02
MAX_TEST_CARS = 100

# Physics
MAXSPEED = 6.0
ROTATESPEED = 5.0
ACCELERATION = 0.12

# Asset paths
TRACK_BORDER = r"data\photo\track1-border.png"
TRACK = r"data\photo\trackv3.png"
BOMB = r'data\photo\bomb.png'
FINISHLINE = r'data\photo/finish.png'
GRASS = r'data\photo\grass2.jpg'
MENU = r'data\photo\Background.jpg'
RECT = r'data\photo\Rect.png'
MENUBG = r'data\photo\Background.jpg'

# Fonts
FONT = r'data\fonts\Menu.ttf'
COUNTDOWN_FONT = r'data\fonts\CountDownFont.otf'
MENUFONT = r'data\fonts\Menu.ttf'

# Sounds
WIN_SOUND = r'data\sound/victory.wav'
COUNTDOWN_SOUND = r'data\sound/countdown.mp3'
BACKGROUND_MUSIC = r'data\sound/background_music.mp3'
COLLIDE_SOUND = r'data\sound/collide.mp3'
CHECKPOINT_SOUND = r'data\sound\CHECKPOINT_SOUND.mp3'
OBSTACLE_SOUND = r'data\sound\obstacle_sound.mp3'

DEFAULT_SOUND_VOLUME = 0.05
DEFAULT_HOVER_VOLUME = 0.01
DEFAULT_CLICK_VOLUME = 0.05
COLLISION_SOUND_VOLUME = 0.25
WIN_SOUND_VOLUME = 0.25
OBSTACLE_SOUND_VOLUME = 0.25
COUNTDOWN_SOUND_VOLUME = 0.6

UI_FONT_SIZE      = 22
UI_DEBUG_SIZE     = 18
UI_COLOR          = (255, 255, 255)
SHADOW_COLOR      = (0, 0, 0)
LINE_HEIGHT       = 26
DEBUG_LINE_HEIGHT = 20
MARGIN_X          = 15
MARGIN_Y_TOP      = 10
MARGIN_Y_BOTTOM   = 10

TRACK_CHECKPOINT_ZONES = [
    [(236, 134), (236, 43)],  # CP 1 | ΔN/Apx
    [(204, 172), (41, 179)],  # CP 2 | Δ87px
    [(204, 491), (41, 491)],  # CP 3 | Δ318px
    [(239, 536), (159, 616)],  # CP 4 | Δ78px
    [(629, 755), (591, 847)],  # CP 5 | Δ460px
    [(722, 737), (885, 736)],  # CP 6 | Δ192px
    [(920, 592), (867, 504)],  # CP 7 | Δ197px
    [(1096, 609), (1179, 525)],  # CP 8 | Δ220px
    [(1104, 733), (1269, 743)],  # CP 9 | Δ190px
    [(1331, 767), (1332, 857)],  # CP 10 | Δ117px
    [(1381, 733), (1542, 726)],  # CP 11 | Δ105px
    [(1381, 470), (1541, 475)],  # CP 12 | Δ260px
    [(1283, 361), (1284, 451)],  # CP 13 | Δ148px
    [(903, 360), (900, 454)],  # CP 14 | Δ383px
    [(877, 348), (716, 348)],  # CP 15 | Δ100px
    [(933, 247), (924, 337)],  # CP 16 | Δ108px
    [(1325, 247), (1325, 338)],  # CP 17 | Δ396px
    [(1375, 235), (1542, 236)],  # CP 18 | Δ91px
    [(1380, 149), (1546, 145)],  # CP 19 | Δ87px
    [(1295, 133), (1301, 45)],  # CP 20 | Δ119px
    [(673, 131), (677, 43)],  # CP 21 | Δ622px
    [(475, 155), (636, 146)],  # CP 22 | Δ88px
    [(476, 375), (638, 376)],  # CP 23 | Δ244px
    [(452, 410), (453, 503)],  # CP 24 | Δ86px
    [(270, 373), (431, 374)],  # CP 25 | Δ92px
    [(268, 275), (430, 275)],  # CP 26 | Δ99px
]

CHECKPOINT_CENTERS = [
    (236.0, 107.9),  # CP 1
    (178.1, 173.1),  # CP 2
    (177.2, 491.0),  # CP 3
    (216.4, 558.6),  # CP 4
    (617.5, 782.9),  # CP 5
    (803.5, 736.5),  # CP 6
    (905.2, 567.4),  # CP 7
    (1125.2, 579.4),  # CP 8
    (1226.8, 740.4),  # CP 9
    (1331.3, 792.7),  # CP 10
    (1416.9, 731.4),  # CP 11
    (1422.7, 471.3),  # CP 12
    (1283.7, 420.5),  # CP 13
    (900.9, 426.1),  # CP 14
    (839.0, 348.0),  # CP 15
    (928.9, 288.3),  # CP 16
    (1325.0, 277.0),  # CP 17
    (1406.1, 235.2),  # CP 18
    (1407.7, 148.3),  # CP 19
    (1296.9, 104.7),  # CP 20
    (674.5, 97.8),  # CP 21
    (602.4, 147.8),  # CP 22
    (515.1, 375.2),  # CP 23
    (452.3, 434.2),  # CP 24
    (383.2, 373.7),  # CP 25
    (383.4, 275.0),  # CP 26
]

BOMB_LIST = [
    (296, 119),
    (359, 120),
    (340, 93),
    (278, 78),
    (245, 64),
    (172, 82),
    (149, 133),
    (99, 140),
    (67, 153),
    (135, 197),
    (107, 249),
    (65, 266),
    (102, 238),
    (144, 329),
    (77, 326),
    (68, 340),
    (116, 396),
    (193, 429),
    (123, 441),
    (98, 495),
    (123, 542),
    (166, 547),
    (196, 614),
    (235, 584),
    (267, 605),
    (315, 625),
    (331, 671),
    (358, 652),
    (372, 692),
    (442, 729),
    (493, 758),
    (517, 778),
    (403, 720),
    (590, 809),
    (585, 819),
    (660, 810),
    (696, 827),
    (744, 786),
    (816, 792),
    (839, 755),
    (822, 682),
    (829, 650),
    (795, 606),
    (843, 570),
    (903, 558),
    (956, 536),
    (1004, 526),
    (1033, 554),
    (1099, 544),
    (1136, 566),
    (1183, 596),
    (1188, 609),
    (1205, 618),
    (1153, 660),
    (1164, 703),
    (1202, 741),
    (1227, 778),
    (1220, 805),
    (1274, 824),
    (1380, 798),
    (1408, 800),
    (1430, 793),
    (1465, 754),
    (1472, 739),
    (1447, 677),
    (1490, 660),
    (1501, 658),
    (1485, 646),
    (1428, 601),
    (1463, 563),
    (1473, 558),
    (1484, 540),
    (1486, 521),
    (1422, 460),
    (1473, 447),
    (1442, 423),
    (1356, 402),
    (1246, 380),
    (984, 386),
    (800, 290),
    (995, 275),
    (1250, 313),
    (1286, 280),
    (1212, 313),
    (1362, 309),
    (1448, 281),
    (1487, 250),
    (1506, 207),
    (1417, 260),
    (1436, 186),
    (1508, 125),
    (1434, 113),
    (1479, 169),
    (1403, 81),
    (1313, 101),
    (1284, 61),
    (1244, 109),
    (1208, 63),
    (1168, 98),
    (1130, 63),
    (1055, 70),
    (980, 82),
    (897, 79),
    (831, 60),
    (769, 78),
    (717, 94),
    (682, 62),
    (659, 96),
    (626, 106),
    (601, 89),
    (552, 129),
    (585, 158),
    (519, 191),
    (610, 308),
    (585, 366),
    (535, 393),
    (565, 426),
    (408, 465),
    (344, 457),
    (305, 396),
    (463, 484),
    (575, 456),
    (298, 424),
    (293, 336),
    (64, 452),
    (102, 349),
    (96, 556),
    (97, 192),
    (118, 88),
    (61, 202),
    (282, 652),
    (158, 588),
    (652, 836),
    (752, 636),
    (851, 529),
    (1070, 513),
    (925, 509),
    (1145, 530),
    (1169, 776),
    (1487, 789),
    (1518, 682),
    (1525, 566),
    (1513, 472),
    (1317, 830),
    (1246, 812),
    (1141, 746),
    (1131, 660),
    (1468, 611),
    (1474, 407),
    (1442, 520),
    (1462, 485),
    (1416, 391),
    (1372, 381),
    (1300, 376),
    (1205, 379),
    (1092, 381),
    (1022, 379),
    (822, 272),
    (759, 306),
    (731, 353),
    (752, 388),
    (1160, 383),
    (1066, 385),
    (1331, 391),
    (1276, 401),
    (871, 262),
    (1143, 325),
    (1333, 328),
    (1404, 318),
    (1523, 237),
    (1289, 324),
    (1446, 222),
    (1517, 160),
    (1467, 90),
    (1363, 56),
    (1155, 257),
    (1237, 257),
    (1323, 302),
    (1337, 60),
    (1257, 84),
    (1171, 61),
    (1088, 71),
    (964, 57),
    (875, 58),
    (806, 79),
    (732, 59),
    (563, 78),
    (509, 142),
    (546, 172),
    (596, 266),
    (558, 320),
    (595, 404),
    (327, 369),
    (337, 408),
    (296, 368),
    (784, 381),
    (795, 322),
    (763, 334),
    (108, 282),
    (77, 410),
    (141, 223),
    (188, 276),
    (138, 265),
    (240, 634),
    (479, 781),
    (789, 751),
    (191, 117),
    (208, 82),
    (403, 117),
    (311, 74),
    (763, 357),
    (848, 264),
    (907, 256),
    (365, 465),
    (530, 471),
    (72, 519),
    (186, 341),
    (623, 380),
    (488, 186),
    (534, 101),
    (635, 58),
    (1023, 55),
    (571, 101),
    (1038, 124),
    (896, 120),
    (1203, 406),
    (1110, 420),
    (1498, 278),
    (1477, 114),
    (1428, 65),
    (1361, 75),
    (1238, 61),
    (923, 61),
    (1512, 618),
    (1514, 514),
    (1494, 435),
    (1508, 755),
    (1414, 832),
    (1203, 823),
    (992, 504),
    (890, 513),
    (779, 571),
    (736, 674),
    (1204, 569),
    (1131, 703),
    (1150, 785),
    (785, 812),
    (528, 802),
    (329, 694),
    (83, 111),
    (374, 94),
    (194, 57),
    (79, 226),
    (79, 385),
    (91, 453),
    (140, 522),
    (109, 166),
    (776, 55),
    (1451, 304),
    (1174, 290),
    (1376, 286),
    (937, 258),
    (793, 277),
    (979, 256),
    (777, 294),
    (739, 326),
    (964, 375),
    (936, 371),
    (927, 381),
    (1043, 398),
    (959, 395),
    (1167, 740),
    (732, 824),
    (811, 551),
    (511, 110),
    (605, 71),
    (252, 82),
    (132, 107),
    (68, 292),
    (105, 310),
    (128, 474),
    (862, 275),
    (758, 598),
    (195, 580),
    (125, 568),
    (67, 482),
    (1373, 830),
    (1447, 812),
    (1503, 715),
    (1492, 580),
    (1114, 80),
    (1221, 82),
    (1310, 64),
    (429, 481),
    (596, 331),
    (532, 128),
    (498, 479),
    (237, 96),
    (151, 179),
    (197, 217),
    (147, 445),
    (215, 565),
    (126, 359),
    (102, 421),
    (874, 548),
    (1246, 413),
    (1155, 411),
    (1077, 414),
    (1322, 417),
    (1000, 420),
    (932, 414),
    (953, 323),
    (1037, 321),
    (1182, 321),
    (1080, 321),
    (994, 321),
    (1094, 263),
    (1035, 263),
    (1467, 137),
    (1479, 214),
    (1011, 75),
    (1147, 81),
    (696, 78),
    (574, 194),
    (571, 398),
    (613, 353),
    (600, 436),
    (496, 147),
    (531, 444),
    (322, 440),
    (321, 337),
    (458, 454),
    (374, 426),
    (356, 346),
    (806, 420),
    (809, 571),
    (868, 709),
    (869, 664),
    (834, 719),
    (450, 749),
    (783, 121),
    (857, 78),
    (975, 122),
    (578, 740),
    (488, 716),
    (507, 218),
    (551, 260),
    (495, 257),
    (488, 300),
    (482, 348),
    (1468, 704),
    (1520, 537)
]